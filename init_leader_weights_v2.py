"""
精确初始化27个部门的院领导权重配置
"""
import sqlite3

DATABASE = 'evaluation.db'

# 27个部门的精确配置
# 格式: (dept_code, dept_name, total_weight, 杨卫胜, 王凌, 许青春, 赵彤, 葛少辉, 刘超伟)
# 注：主管领导获得15%，其他4人均分5% (每人1.25%)
# 院长助理特殊：杨卫胜40%，其他5人均分30% (每人6%)
# 昆冈特殊：见具体配置

DEPT_CONFIGS = [
    # 1. 院长助理 (A1): 70%, 杨40%, 其他5人均分30%=6%each
    ('A1', '院长助理', 70, 40, 6, 6, 6, 6, 6),
    
    # 2. 兰州化工研究中心 (X): 50%, 杨30%, 杨卫胜主管15%, 其他5人均分5%=1%each
    ('X', '兰州化工研究中心', 50, 45, 1, 1, 1, 1, 1),
    
    # 3. 大庆化工研中心 (Y): 50%, 杨30%, 杨卫胜主管15%
    ('Y', '大庆化工研中心', 50, 45, 1, 1, 1, 1, 1),
    
    # 4. 办公室/党委办公室 (A): 50%, 杨30%, 杨卫胜主管15%
    ('A', '办公室/党委办公室', 50, 45, 1, 1, 1, 1, 1),
    
    # 5. 工艺工程研究所 (Q): 50%, 杨30%, 杨卫胜主管15%
    ('Q', '工艺工程研究所', 50, 45, 1, 1, 1, 1, 1),
    
    # 6. 财务部 (C): 50%, 杨30%, 王凌主管15%
    ('C', '财务部', 50, 30, 15, 1.25, 1.25, 1.25, 1.25),
    
    # 7. 合成树脂研究所 (P): 50%, 杨30%, 王凌主管15%
    ('P', '合成树脂研究所', 50, 30, 15, 1.25, 1.25, 1.25, 1.25),
    
    # 8. 新材料研究所 (S): 50%, 杨30%, 王凌主管15%
    ('S', '新材料研究所', 50, 30, 15, 1.25, 1.25, 1.25, 1.25),
    
    # 9. 生物化工研究所 (L2): 50%, 杨30%, 王凌主管15%
    ('L2', '生物化工研究所', 50, 30, 15, 1.25, 1.25, 1.25, 1.25),
    
    # 10. 氢能、化工研究所 (M): 50%, 杨30%, 王凌主管15%
    ('M', '氢能、化工研究所', 50, 30, 15, 1.25, 1.25, 1.25, 1.25),
    
    # 11. 人力资源部/党委组织部 (D): 50%, 杨30%, 许青春主管15%
    ('D', '人力资源部/党委组织部', 50, 30, 1.25, 15, 1.25, 1.25, 1.25),
    
    # 12. 党群工作部（党委宣传部）(H): 50%, 杨30%, 许青春主管15%
    ('H', '党群工作部（党委宣传部）', 50, 30, 1.25, 15, 1.25, 1.25, 1.25),
    
    # 13. 纪委办公室 (B): 50%, 杨30%, 赵彤主管15%
    ('B', '纪委办公室', 50, 30, 1.25, 1.25, 15, 1.25, 1.25),
    
    # 14. 条件保障部 运维服务中心 (E): 50%, 杨30%, 葛少辉主管15%
    ('E', '条件保障部 运维服务中心', 50, 30, 1.25, 1.25, 1.25, 15, 1.25),
    
    # 15. 知识产权中心（集团公司...）(I): 50%, 杨30%, 葛少辉主管15%
    ('I', '知识产权中心（集团公司炼化和新材料知识产权技术支持中心）', 50, 30, 1.25, 1.25, 1.25, 15, 1.25),
    
    # 16. 技术推广中心 (J): 50%, 杨30%, 葛少辉主管15%
    ('J', '技术推广中心', 50, 30, 1.25, 1.25, 1.25, 15, 1.25),
    
    # 17. 清洁燃料研究所 (N): 50%, 杨30%, 葛少辉主管15%
    ('N', '清洁燃料研究所', 50, 30, 1.25, 1.25, 1.25, 15, 1.25),
    
    # 18. 重油加工研究所 (O): 50%, 杨30%, 葛少辉主管15%
    ('O', '重油加工研究所', 50, 30, 1.25, 1.25, 1.25, 15, 1.25),
    
    # 19. 科研部 (G): 50%, 杨30%, 刘超伟主管15%
    ('G', '科研部', 50, 30, 1.25, 1.25, 1.25, 1.25, 15),
    
    # 20. 质量健康安全环保部 (F): 50%, 杨30%, 刘超伟主管15%
    ('F', '质量健康安全环保部', 50, 30, 1.25, 1.25, 1.25, 1.25, 15),
    
    # 21. 数智技术中心 (K): 50%, 杨30%, 刘超伟主管15%
    ('K', '数智技术中心', 50, 30, 1.25, 1.25, 1.25, 1.25, 15),
    
    # 22. 基础前沿技术研究所 (R): 50%, 杨30%, 刘超伟主管15%
    ('R', '基础前沿技术研究所', 50, 30, 1.25, 1.25, 1.25, 1.25, 15),
    
    # 23. 分析表征研究所 (L1): 50%, 杨30%, 刘超伟主管15%
    ('L1', '分析表征研究所', 50, 30, 1.25, 1.25, 1.25, 1.25, 15),
    
    # 24. 战略与信息研究所 (T): 50%, 杨30%, 刘超伟主管15%
    ('T', '战略与信息研究所', 50, 30, 1.25, 1.25, 1.25, 1.25, 15),
    
    # 25. 昆冈先进制造（北京）有限公司 (U): 20%, 杨12%, 刘超伟6%, 其他4人均分2%=0.5%each
    ('U', '昆冈先进制造（北京）有限公司', 20, 12, 0.5, 0.5, 0.5, 0.5, 6),
    
    # 26. 昆冈兰州分公司 (V): 10%, 杨6%, 刘超伟3%, 其他4人均分1%=0.25%each
    ('V', '昆冈兰州分公司', 10, 6, 0.25, 0.25, 0.25, 0.25, 3),
    
    # 27. 昆冈抚顺分公司 (W): 10%, 杨6%, 刘超伟3%, 其他4人均分1%=0.25%each
    ('W', '昆冈抚顺分公司', 10, 6, 0.25, 0.25, 0.25, 0.25, 3),
]

def main():
    conn = sqlite3.connect(DATABASE)
    cursor = conn.cursor()
    
    # 清空现有配置
    print("清空现有 leader_weight_config...")
    cursor.execute('DELETE FROM leader_weight_config')
    
    # 插入27条记录
    for cfg in DEPT_CONFIGS:
        cursor.execute('''
            INSERT INTO leader_weight_config 
                (dept_code, dept_name, total_weight, w_yang_weisheng, w_wang_ling, w_xu_qingchun, w_zhao_tong, w_ge_shaohui, w_liu_chaowei)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
        ''', cfg)
    
    conn.commit()
    conn.close()
    
    print(f"成功初始化 {len(DEPT_CONFIGS)} 个部门的院领导权重配置")

if __name__ == '__main__':
    main()
