# 中心副职被考核人打分汇总计算实施计划

## 目标
针对**兰州化工研究中心 (X)** 和 **大庆化工研究中心 (Y)** 的 **中心副职** 人员，进行考核分数的汇总与计算。
**关键要求**：保持原“被考核人打分汇总表”的 Excel 结构不变，仅在指定的表头列中填入计算出的分数，并依据查得的权重计算总分。

## 涉及文件
#### [NEW] [calculate_center_deputy.py](file:///c:/Users/Dennis/Desktop/cadre/leader/calculate_center_deputy.py)
- 核心计算与导出脚本。

## 权重配置与计算规则

### 1. 考核对象
- **部门**: 兰州化工研究中心 (`X`)、大庆化工研究中心 (`Y`)。
- **角色**: 中心副职。

### 2. 评分维度与具体权重
根据数据库配置与业务规则，各维度权重如下（总计 100%）：

| 序号 | 表头名称 (评分维度) | 权重 (Weight) | 数据来源 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **A** | **院领导评分** | **50%** | `leader_weight_config` | 根据 `init_leader_weights_v2.py` 配置，两中心院领导总权重为 50%。<br>计算公式：$\sum (分数 \times 归一化后的个人权重)$ |
| **B** | **中心及昆冈正职评分** | **20%** | `weight_config_dept` | 评分人角色：中心正职、昆冈正职。<br>计算方式：去除无效分后的算术平均分。 |
| **C** | **中心及昆冈副职评分** | **10%** | `weight_config_dept` | 评分人角色：中心副职。<br>计算方式：算术平均分。 |
| **D** | **基层领导评分（两中心）** | **10%** | `weight_config_dept` | 评分人角色：中心基层领导 (仅限兰州/大庆)。<br>计算方式：算术平均分。 |
| **E** | **中心及昆冈其他员工评分** | **10%** | `weight_config_dept` | 评分人角色：其他员工。<br>计算方式：算术平均分。 |

**最终得分** = $A \times 0.5 + B \times 0.2 + C \times 0.1 + D \times 0.1 + E \times 0.1$

### 3. 输出格式
- **目标文件**: 保持现有的“被考核人打分汇总” Excel 格式。
- **操作逻辑**:
  1. 读取现有的计算逻辑生成的基础数据结构（包含姓名、部门、职务等）。
  2. 针对“中心副职”行，定位到上述 A~E 五个表头列。
  3. 填入计算出的 A~E 原始分（保留2位小数）。
  4. 更新“总分”列。

## 实施步骤

1.  **数据读取**:
    - 获取 Dept X/Y 的中心副职人员名单。
    - 获取所有相关的原始评分数据 (`personnel_scores`)。
2.  **分项计算**:
    - **院领导**: 根据 `leader_weight_config` (X/Y 部门) 匹配评分人与被评人，加权计算。
    - **民主测评 (B/C/D/E)**: 根据评分人角色筛选打分记录，计算平均分。
        - 需特别处理“基层领导”，仅限本中心（两中心范围内）。
        - 需特别处理“中心及昆冈”，包含两中心及昆冈相关部门的评分人。
3.  **结果合成**:
    - 使用 `pandas` 生成或更新 Excel。
    - 确保列名严格匹配用户要求的表头：`院领导评分`、`中心及昆冈正职评分`、`中心及昆冈副职评分`、`基层领导评分（两中心）`、`中心及昆冈其他员工评分`。
4.  **验证**:
    - 输出一位示例人员的各项得分与总分，人工核对权重计算是否正确。

## 交付物
- `calculate_center_deputy.py` 脚本。
- 包含计算结果的 Excel 文件。
